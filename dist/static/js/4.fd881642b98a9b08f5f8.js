webpackJsonp([4],{B08B:function(e,t){},JotD:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("Dd8w"),i=a.n(s),n=a("NYxO"),l={data:function(){return{dialogVisibleCheck:!1,paperType:!1,addType:"",quesType:"",addTypeVisible:!1,quesDialogVisible:!1,randomVisible:!1,randonNum:"",title:"",question:"",selectData:[],caseData:[],videoData:[],questionType:{select:!1,case:!1,video:!1},questionLibrary:{},currentTypeQues:[],examMsg:{},currentTopic:{}}},computed:i()({},Object(n.c)({questionTypeList:"questionTypeList"})),watch:{examMsg:function(){var e=this;this.$ajax.get("/hmu/tea/getPaperByExam/"+this.examMsg.examName).then(function(t){t.result?e.$message({type:"error",message:"获取试卷信息失败！"}):(e.selectData=t.data.select.questions||[],e.selectData.forEach(function(e){e.accuracy=(100*e.accuracy).toFixed(2)+"%"}),e.caseData=t.data.caseQuestions||[],0!==e.selectData.length&&(e.questionType.select=!0),0!==e.caseData.length&&(e.questionType.case=!0))}).catch(function(t){e.$message({type:"error",message:t})})}},methods:{goBack:function(){this.$router.push({name:"paperMaintenance"})},addTypeDialog:function(){this.addTypeVisible=!0},handleClose:function(){this.addType="",this.randonNum="",this.randomVisible=!1,this.addTypeVisible=!1},addTypeSure:function(){this.questionType[this.addType]=!0,this.getQuestions(this.addType),this.handleClose()},openTopic:function(e){this.quesType=e,this.currentTypeQues=this.questionLibrary[e],this.quesDialogVisible=!0},getQuestions:function(e){var t=this;this.$ajax.post("/hmu/tea/getQuestionByDepartment",{department:this.examMsg.department,questionType:e}).then(function(a){a.result?t.$message({type:"error",message:"获取题库试题失败！"}):t.questionLibrary[e]=a.data}).catch(function(e){t.$message({type:"error",message:e})})},addTopic:function(e){if("select"===this.quesType){if(this.selectData.some(function(t){return t.questionId===e.questionId}))return void this.exisMessage();this.selectData.push(e)}if("case"===this.quesType){if(this.caseData.some(function(t){return t.questionId===e.questionId}))return void this.exisMessage();this.caseData.push(e)}if("video"===this.quesType){if(this.videoData.some(function(t){return t.questionId===e.questionId}))return void this.exisMessage();this.videoData.push(e)}},randomAddTopic:function(e){this.currentTypeQues=this.questionLibrary[e],this.randomVisible=!0},randomTopic:function(){var e=+this.randonNum;console.log(e),this.handleClose()},handleCheck:function(e){this.currentTopic=e,this.dialogVisibleCheck=!0},handleDelete:function(e,t){this[e]=this[e].filter(function(e){return e.questionId!==t.questionId})},exisMessage:function(){this.$message({type:"error",message:"您选择的题目已经存在"})},savePaper:function(){var e=this,t=[],a=0;this.selectData.forEach(function(s){a+=5;var i={questionId:s.questionId,questionType:"select",examName:e.examMsg.examName};t.push(i)}),this.caseData.forEach(function(s){a+=5*s.questions.length;var i={questionId:s.questionId,questionType:"case",examName:e.examMsg.examName};t.push(i)}),100===a?this.$ajax.put("/hmu/tea/updatePaper",t).then(function(t){t.result?e.$message({type:"error",message:"保存试题失败！"}):(e.$message({type:"success",message:"保存试题成功！"}),e.goBack())}).catch(function(t){e.$message({type:"error",message:t})}):this.$message({type:"error",message:"试卷总分数应为100分， 现在试卷总分数为"+a+"分"})}},components:{quesDialog:function(e){return a.e(17).then(function(){var t=[a("3/Po")];e.apply(null,t)}.bind(this)).catch(a.oe)},checkQues:function(e){return a.e(16).then(function(){var t=[a("9gA5")];e.apply(null,t)}.bind(this)).catch(a.oe)}},beforeRouteEnter:function(e,t,a){a(function(t){e.params.examMsg&&(t._data.examMsg=e.params.examMsg,t._data.paperType=e.params.paperType)})}},o={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"ae-paper"},[a("el-page-header",{attrs:{content:e.title},on:{back:e.goBack}}),e._v(" "),a("el-row",[a("el-col",{staticClass:"paper-name",attrs:{span:18}},[a("span",[e._v(e._s(e.examMsg.grade)+e._s(e.examMsg.type)+e._s(e.examMsg.department)+"第"+e._s(e.examMsg.turn)+"轮考试")])]),e._v(" "),e.paperType?a("el-col",{attrs:{span:6}},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.addTypeDialog}},[e._v("添加题型")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.savePaper}},[e._v("保存试卷")])],1):e._e()],1),e._v(" "),e.questionType.select?a("div",{staticClass:"paper-table"},[a("h1",{staticClass:"ques-type"},[e._v("\n      题型一: 选择题\n      "),e.paperType?a("div",[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.openTopic("select")}}},[e._v("添加试题")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.randomAddTopic("select")}}},[e._v("随机出题")])],1):e._e()]),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.selectData,"header-cell-style":{background:"rgb(235,244,248)"},"row-style":{background:"rgb(240,248,250)"},size:"small"}},[a("el-table-column",{attrs:{type:"index",width:"50",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"question",label:"题目"}}),e._v(" "),a("el-table-column",{attrs:{prop:"rightAnswer",label:"正确答案",width:"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"accuracy",label:"准确率",width:"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){return e.handleCheck(t.row)}}},[e._v("查看")]),e._v(" "),e.paperType?a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.handleDelete("selectData",t.row)}}},[e._v("删除")]):e._e()]}}],null,!1,182323863)})],1)],1):e._e(),e._v(" "),e.questionType.case?a("div",{staticClass:"paper-table"},[a("h1",{staticClass:"ques-type"},[e._v("\n      题型二: 案例题\n      "),e.paperType?a("div",[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.openTopic("case")}}},[e._v("添加试题")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.randomAddTopic("case")}}},[e._v("随机出题")])],1):e._e()]),e._v(" "),e._l(e.caseData,function(t,s){return a("div",{key:s,staticClass:"case-title"},[a("span",[e._v("  案例"+e._s(s+1)+"： "+e._s(t.question))]),e._v(" "),e.paperType?a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){return e.handleDelete("caseData",t)}}},[e._v("删除")]):e._e(),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.questions,"header-cell-style":{background:"rgb(235,244,248)"},"row-style":{background:"rgb(240,248,250)"},size:"small"}},[a("el-table-column",{attrs:{type:"index",width:"50",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"question",label:"题目"}}),e._v(" "),a("el-table-column",{attrs:{prop:"rightAnswer",label:"正确答案",width:"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){return e.handleCheck(t.row)}}},[e._v("查看")])]}}],null,!0)})],1)],1)})],2):e._e(),e._v(" "),e.questionType.video?a("div",{staticClass:"paper-table"},[a("h1",{staticClass:"ques-type"},[e._v("\n      题型三: 视频题\n      "),e.paperType?a("div",[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.openTopic("video")}}},[e._v("添加试题")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.randomAddTopic("video")}}},[e._v("随机出题")])],1):e._e()]),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.videoData,"header-cell-style":{background:"rgb(235,244,248)"},"row-style":{background:"rgb(240,248,250)"},size:"small"}},[a("el-table-column",{attrs:{prop:"topic",label:"题目"}}),e._v(" "),a("el-table-column",{attrs:{prop:"rightAnswer",label:"正确答案",width:"180",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){return e.handleCheck(t.row)}}},[e._v("查看")]),e._v(" "),e.paperType?a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.handleDelete("videoData",t.row)}}},[e._v("删除")]):e._e()]}}],null,!1,2978185006)})],1)],1):e._e(),e._v(" "),a("el-dialog",{attrs:{title:"添加题型",visible:e.addTypeVisible,width:"30%","before-close":e.handleClose},on:{"update:visible":function(t){e.addTypeVisible=t}}},[a("el-select",{attrs:{placeholder:"请选择要添加的题型"},model:{value:e.addType,callback:function(t){e.addType=t},expression:"addType"}},e._l(e.questionTypeList,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.addTypeSure}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"随机出题",visible:e.randomVisible,width:"30%","before-close":e.handleClose},on:{"update:visible":function(t){e.randomVisible=t}}},[a("el-input",{attrs:{placeholder:"请输入随机出题的数目"},model:{value:e.randonNum,callback:function(t){e.randonNum=t},expression:"randonNum"}}),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.randomTopic}},[e._v("确 定")])],1)],1),e._v(" "),a("ques-dialog",{attrs:{dialogVisible:e.quesDialogVisible,currentTypeQues:e.currentTypeQues,quesType:e.quesType},on:{"update:dialogVisible":function(t){e.quesDialogVisible=t},"update:dialog-visible":function(t){e.quesDialogVisible=t},addTopic:e.addTopic}}),e._v(" "),a("check-ques",{attrs:{dialogVisible:e.dialogVisibleCheck,currentTopic:e.currentTopic},on:{"update:dialogVisible":function(t){e.dialogVisibleCheck=t},"update:dialog-visible":function(t){e.dialogVisibleCheck=t}}})],1)},staticRenderFns:[]};var r=a("VU/8")(l,o,!1,function(e){a("B08B")},"data-v-f974f1cc",null);t.default=r.exports}});
//# sourceMappingURL=4.fd881642b98a9b08f5f8.js.map